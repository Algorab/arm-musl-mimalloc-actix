# Project debugging armv7(raspberrypi ) + actix + musl + mimalloc

This is a extraction from my larger project.

## What happened
Sometimes on the raspberry pi the cross compiled binary is not able to start. It happens mostly rather not, so maybe
some retries are required.

## Error messages

### Valgrind
```shell
RUST_BACKTRACE=1 valgrind ./arm-musl-mimalloc-actix

==12725== Memcheck, a memory error detector
==12725== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==12725== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==12725== Command: ./arm-musl-mimalloc-actix
==12725== 
--12725-- WARNING: unhandled syscall: 384
--12725-- You may be able to write your own handler.
--12725-- Read the file README_MISSING_SYSCALL_OR_IOCTL.
--12725-- Nevertheless we consider this a bug.  Please report
--12725-- it at http://valgrind.org/support/bug_reports.html.
--12725-- WARNING: unhandled syscall: 357
--12725-- You may be able to write your own handler.
--12725-- Read the file README_MISSING_SYSCALL_OR_IOCTL.
--12725-- Nevertheless we consider this a bug.  Please report
--12725-- it at http://valgrind.org/support/bug_reports.html.
thread 'main' panicked at 'Default Actix (Tokio) runtime could not be created.: Os { code: 38, kind: Unsupported, message: "Function not implemented" }', /root/.cargo/registry/src/github.com-1ecc6299db9ec823/actix-rt-2.4.0/src/system.rs:42:18
stack backtrace:
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.
==12725== Invalid read of size 4
==12725==    at 0x54D604: ??? (in /home/pi/arm-musl-mimalloc-actix)
==12725==  Address 0xbdb79d4c is not stack'd, malloc'd or (recently) free'd
==12725== 
==12725== 
==12725== HEAP SUMMARY:
==12725==     in use at exit: 0 bytes in 0 blocks
==12725==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated
==12725== 
==12725== All heap blocks were freed -- no leaks are possible
==12725== 
==12725== For counts of detected and suppressed errors, rerun with: -v
==12725== ERROR SUMMARY: 4 errors from 1 contexts (suppressed: 0 from 0)

```

### Core dump

```shell
 ulimit -c unlimied
 ./arm-musl-mimalloc-actix
 rust-gdb arm-musl-mimalloc-actix core
 
rust-gdb arm-musl-mimalloc-actix core
GNU gdb (Raspbian 8.2.1-2) 8.2.1
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "arm-linux-gnueabihf".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.
--Type <RET> for more, q to quit, c to continue without paging--c

For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from arm-musl-mimalloc-actix...done.

warning: core file may not match specified executable file.
[New LWP 12768]
[New LWP 12764]
[New LWP 12763]
[New LWP 12767]
[New LWP 12765]
[New LWP 12766]
Core was generated by `./arm-musl-mimalloc-actix'.
Program terminated with signal SIGABRT, Aborted.
#0  0x0055079c in __syscall4 (n=175, d=8, c=0, b=-1302384880, a=2) at ./arch/arm/syscall_arch.h:75
75      ./arch/arm/syscall_arch.h: Datei oder Verzeichnis nicht gefunden.
[Current thread is 1 (LWP 12768)]

```

# How to reproduce

## Build armv7 version

## How to reproduce

* source the ```.env``` file
* ``` mkdir carog-registry```
* ``` build-arm-debug```
* copy the ```target/armv7-unknown-linux-musleabihf/debug/arm-musl-mimalloc-actix``` to the  
  rasberry and start it.

As I above-mentioned maybe some retries are required to produce the error.